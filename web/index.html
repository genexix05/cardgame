<!DOCTYPE html>
<html>
<head>
  <!-- Base href (igual que antes) -->
  <base href="$FLUTTER_BASE_HREF">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="A new Flutter project.">

  <!-- iOS meta tags & icons -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="cardgame">
  <link rel="apple-touch-icon" href="../assets/icons/icon.png">

  <!-- Google Sign-In: tu Client ID -->
  <meta
    name="google-signin-client_id"
    content="1074439862642-joo805hjq6e8rc8llbavh3bgmt2brv8r.apps.googleusercontent.com"
  >

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="../assets/icons/icon.png"/>

  <!-- 1) COOP/COEP para permitir popups sin romper aislamiento -->
  <meta
    http-equiv="Cross-Origin-Opener-Policy"
    content="same-origin-allow-popups"
  >
  <meta
    http-equiv="Cross-Origin-Embedder-Policy"
    content="require-corp"
  >

  <!-- 2) Carga de Google APIs y GSI antes de Flutter -->
  <script src="https://apis.google.com/js/api.js" async defer></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <title>cardgame</title>
  <link rel="manifest" href="manifest.json">
</head>
<body>
  <!-- 1) Contenedor para la inicialización automática -->
  <div
    id="g_id_onload"
    data-client_id="1074439862642-joo805hjq6e8rc8llbavh3bgmt2brv8r.apps.googleusercontent.com"
    data-auto_select="false"
    data-callback="handleCredentialResponse">
  </div>

  <!-- 2) Contenedor donde se pintará el botón estándar -->
  <div
    class="g_id_signin"
    data-type="standard"
    data-size="large"
    data-theme="outline"
    data-text="signin_with"
    data-shape="rectangular"
    data-logo_alignment="left">
  </div>

  <script>
    // callback que recibe el JWT en response.credential
    function handleCredentialResponse(response) {
      // Aquí tienes el id_token en response.credential
      // Por ejemplo, lo puedes enviar a Flutter vía postMessage:
      window.parent.postMessage({
        type: 'google-credential',
        credential: response.credential
      }, '*');
    }
  </script>

  <!-- Bootstrap de Flutter: no lo muevas -->
  <script src="flutter_bootstrap.js" async></script>
</body>

</html>
